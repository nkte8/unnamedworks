---
import { getAllPosts } from "@/utils/newt.ts";
import Data from "@/utils/data.json";
type Post = typeof Data;

export async function getStaticPaths() {
    const response = await getAllPosts();
    var posts: Post[] = response?.items;
    posts = posts.sort(
        (a, b) => new Date(b.pubDate).getTime() - new Date(a.pubDate).getTime(),
    );

    let aroud_info = posts.map((entry) => {
        return {
            slug: entry.slug,
            title: entry.title,
        };
    });

    return posts.map((entry, index) => ({
        params: {
            slug: baseurl + entry.slug,
        },
        props: {
            entry,
            prev: aroud_info[index + 1],
            next: aroud_info[index - 1],
        },
    }));
}

interface Props {
    entry: Post;
    prev: Post | undefined;
    next: Post | undefined;
}
const { entry, prev, next } = Astro.props;

import Pagerender from "@/layouts/Pagerender.astro";
export const baseurl = "/post/";
---

<Pagerender entry={entry} prev={prev} next={next} baseurl={baseurl} />
