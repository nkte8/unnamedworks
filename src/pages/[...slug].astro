---
import { getCollection } from 'astro:content';

// 1. コレクションエントリーごとに新しいパスを生成
// const baseurl = String(Astro.url.pathname).split("/").slice(0,-1).join("/") + "/"

export async function getStaticPaths() {
  const blogEntries = await getCollection('posts');
  let aroud_info:any = [];

  let sorted = blogEntries.sort(
    (a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime()
  );

  aroud_info = sorted.map(entry => {
    return {
      slug: entry.slug,
      title: entry.data.title,
    }
  })

  return sorted.map((entry,index) => ({
    params:{
      slug: baseurl + entry.slug
    },
    props: {
      entry,
      prev: aroud_info[index +1],
      next: aroud_info[index -1]
    }
  }))
}

const { entry, prev, next } = Astro.props;
const { Content } = await entry.render();
import '@/styles/pagelist.css'
import BaseLayout from '@/layouts/MarkdownLayout.astro'

export const baseurl = "/post/"
---
<BaseLayout frontmatter={entry.data}>
    <Content />
    <div class="pagelist-buttons">
      <div class="left">{next !== undefined && <a href={baseurl + next.slug}>&lt; {next.title}</a>}</div>
      <div class="center">{entry.data.title}</div>
      <div class="right">{prev !== undefined && <a href={baseurl + prev.slug}>{prev.title} &gt;</a>}</div>
    </div>
</BaseLayout>
