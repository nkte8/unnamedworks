---
import { getCollection } from 'astro:content';

// 1. コレクションエントリーごとに新しいパスを生成
// const baseurl = String(Astro.url.pathname).split("/").slice(0,-1).join("/") + "/"

export async function getStaticPaths() {
  const blogEntries = await getCollection('posts');
  let aroud_info:any = [];

  let sorted = blogEntries.sort(
    (a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime()
  );

  aroud_info = sorted.map(entry => {
    return {
      slug: entry.slug,
      title: entry.data.title,
    }
  })

  return sorted.map((entry,index) => ({
    params:{
      slug: baseurl + entry.slug
    },
    props: {
      entry,
      prev: aroud_info[index +1],
      next: aroud_info[index -1]
    }
  }))
}

const { entry, prev, next } = Astro.props;
const { Content } = await entry.render();
import BaseLayout from '@/layouts/MarkdownLayout.astro'
import Pagelist_buttons from '@/components/pagelist_buttons/main.astro'

export const baseurl = "/post/"
---
<BaseLayout frontmatter={entry.data}>
    <Content />
</BaseLayout>
<Pagelist_buttons baseurl={baseurl} nextlink={next !== undefined && next.slug} prevlink={prev !== undefined && prev.slug}, current={entry} >
